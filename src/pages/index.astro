---
import Layout from '../layouts/Layout.astro';
import SocialLinks from '../components/SocialLinks.astro';
import { getCollection } from 'astro:content';
import ProjectCard from '../components/ProjectCard.astro';
import { personSchema, websiteSchema } from '../lib/schema.ts';

const allProjects = (await getCollection('projects')).sort(
  (a, b) => a.data.priority - b.data.priority,
);

const jsonLd = {
  '@context': 'https://schema.org',
  '@graph': [
    websiteSchema,
    {
      '@type': 'ProfilePage',
      '@id': 'https://hawksley.dev/#webpage',
      url: 'https://hawksley.dev/',
      name: 'About Ethan Hawksley',
      isPartOf: { '@id': 'https://hawksley.dev/#website' },
      mainEntity: { '@id': 'https://hawksley.dev/#person' },
      inLanguage: 'en-GB',
    },
    personSchema,
    {
      '@type': 'ItemList',
      name: "Ethan Hawksley's Projects",
      itemListElement: allProjects.map((project, index) => ({
        '@type': 'ListItem',
        position: index + 1,
        item: {
          '@type': 'SoftwareApplication',
          name: project.data.name,
          description: project.data.description,
          applicationCategory: 'DeveloperApplication',
          operatingSystem: 'Any',
          url: project.data.liveUrl || project.data.sourceUrl,
          ...(project.data.sourceUrl && {
            installUrl: project.data.sourceUrl,
          }),
          author: { '@id': 'https://hawksley.dev/#person' },
          offers: {
            '@type': 'Offer',
            price: '0',
            priceCurrency: 'GBP',
          },
        },
      })),
    },
  ],
};
---

<Layout
  pageTitle="Ethan Hawksley | Software Developer & CS Student"
  pageDescription="Portfolio of Ethan Hawksley, a UK-based CS student and developer building tools with Rust and JavaScript. Explore my projects and source code."
  highlightedLink="home"
  jsonLd={jsonLd}
  ogType="profile"
>
  <section id="hero" aria-labelledby="hero-heading">
    <h1 id="hero-heading">Ethan Hawksley</h1>
    <p>
      Hi, I'm Ethan Hawksley, a CS student at Alcester Grammar School.
      I&nbsp;build webapps, use Linux, and write Rust when performance matters.
    </p>
  </section>
  <div id="contact-links">
    <SocialLinks />
  </div>
  <section id="projects" aria-labelledby="projects-heading">
    <h2 id="projects-heading">Projects</h2>
    <div id="projects-grid">
      {
        allProjects.map((project) => (
          <ProjectCard
            name={project.data.name}
            description={project.data.description}
            sourceUrl={project.data.sourceUrl}
            liveUrl={project.data.liveUrl}
          />
        ))
      }
    </div>
  </section>
  <style>
    #hero {
      text-wrap: balance;
      margin-bottom: 0.5rem;
      max-width: 65ch;
    }

    h1 {
      font-size: var(--font-size-2xl);
      margin-bottom: 1.5rem;
      text-decoration: var(--color-accent) underline 3px;
      text-underline-offset: 0.5rem;
      font-weight: var(--font-weight-semibold);
      line-height: var(--line-height-tight);
    }

    #contact-links {
      margin-bottom: 2rem;
    }

    h2 {
      font-size: var(--font-size-xl);
      margin-bottom: 1.5rem;
      font-weight: var(--font-weight-semibold);
      line-height: var(--line-height-snug);
    }

    p {
      font-size: var(--font-size-base);
      line-height: var(--line-height-normal);
    }

    #projects-grid {
      display: grid;
      column-gap: 1rem;
      row-gap: 1rem;
    }

    @media (min-width: 750px) {
      #projects-grid {
        grid-template-columns: 1fr 1fr;
      }
    }
  </style>
</Layout>
