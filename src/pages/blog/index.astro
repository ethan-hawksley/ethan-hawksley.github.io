---
import Layout from '../../layouts/Layout.astro';
import { getCollection } from 'astro:content';
import PostPreview from '../../components/PostPreview.astro';

const allPosts = (await getCollection('posts')).sort((a, b) =>
  a.data.pubDate < b.data.pubDate ? 1 : -1,
);

const jsonLd = {
  '@context': 'https://schema.org',
  '@graph': [
    {
      '@type': 'WebSite',
      '@id': 'https://hawksley.dev/#website',
      url: 'https://hawksley.dev/',
      name: 'Ethan Hawksley | Software Developer & CS Student',
      publisher: { '@id': `https://hawksley.dev/#person` },
    },
    {
      '@type': 'Person',
      '@id': `https://hawksley.dev/#person`,
      name: 'Ethan Hawksley',
      url: 'https://hawksley.dev/',
      sameAs: [
        'https://github.com/ethan-hawksley',
        'https://www.linkedin.com/in/ethan-hawksley',
        'https://x.com/Ethan_Hawksley',
      ],
    },
    {
      '@type': 'Blog',
      '@id': 'https://hawksley.dev/blog/#blog',
      mainEntityOfPage: 'https://hawksley.dev/blog/',
      name: "Ethan Hawksley's Blog",
      description:
        'A technical blog featuring articles on software engineering, Rust, and computer science.',
      publisher: { '@id': 'https://hawksley.dev/#person' },
      inLanguage: 'en-GB',
      blogPost: allPosts.map((post) => ({
        '@type': 'BlogPosting',
        headline: post.data.title,
        description: post.data.description,
        datePublished: post.data.pubDate.toISOString(),
        dateModified: (
          post.data.modifiedDate || post.data.pubDate
        ).toISOString(),
        author: { '@id': 'https://hawksley.dev/#person' },
        url: `https://hawksley.dev/blog/${post.id}/`,
        keywords: post.data.tags,
        mainEntityOfPage: `https://hawksley.dev/blog/${post.id}/`,
      })),
    },
    {
      '@type': 'BreadcrumbList',
      itemListElement: [
        {
          '@type': 'ListItem',
          position: 1,
          name: 'Home',
          item: 'https://hawksley.dev/',
        },
        {
          '@type': 'ListItem',
          position: 2,
          name: 'Blog',
          item: 'https://hawksley.dev/blog/',
        },
      ],
    },
  ],
};
---

<Layout
  pageTitle="Blog | Ethan Hawksley - Software Developer & CS Student"
  pageDescription="A technical blog by Ethan Hawksley. "
  highlightedLink="blog"
  jsonLd={jsonLd}
  ogType="website"
>
  <h1>Blog</h1>
  <ul>
    {
      allPosts.map((post) => (
        <PostPreview
          url={`/blog/${post.id}/`}
          title={post.data.title}
          description={post.data.description}
          pubDate={post.data.pubDate}
          tags={post.data.tags}
        />
      ))
    }
  </ul>
</Layout>
<style>
  h1 {
    font-size: 2rem;
    margin-bottom: 1.5rem;
    text-decoration: var(--color-accent) underline 3px;
    text-underline-offset: 0.5rem;
    line-height: 1.2;
    font-weight: 600;
  }

  ul {
    list-style: none;
    padding: 0;
    display: flex;
    flex-direction: column;
    gap: 1rem;
    max-width: 65ch;
  }
</style>
